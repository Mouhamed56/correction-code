<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Composant de Carte de Prix</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .demo-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            max-width: 1200px;
            width: 100%;
        }

        /* Styles pour le Web Component (seront encapsulés dans Shadow DOM) */
        pricing-card {
            display: block;
        }
    </style>
</head>
<body>
    <div class="demo-container">
        <!-- Exemple d'utilisation du composant -->
        <pricing-card
            title="Forfait de base"
            price="9,99"
            currency="€"
            period="mois"
            features='["1 Go de stockage", "Assistance de base", "Toutes les fonctionnalités principales"]'
            cta="Démarrer l'essai"
        ></pricing-card>

        <pricing-card
            title="Forfait Pro"
            price="29,99"
            currency="€"
            period="mois"
            features='["10 Go de stockage", "Assistance prioritaire", "Toutes les fonctionnalités principales", "Support 24/7", "Backup automatique"]'
            cta="Choisir Pro"
            featured
        ></pricing-card>

        <pricing-card
            title="Forfait Entreprise"
            price="99,99"
            currency="€"
            period="mois"
            features='["Stockage illimité", "Assistance dédiée", "Toutes les fonctionnalités principales", "Support 24/7", "Backup automatique", "API personnalisée", "Gestionnaire de compte"]'
            cta="Nous contacter"
        ></pricing-card>
    </div>

    <script>
        class PricingCard extends HTMLElement {
            constructor() {
                super();
                this.attachShadow({ mode: 'open' });
            }

            static get observedAttributes() {
                return ['title', 'price', 'currency', 'period', 'features', 'cta', 'featured'];
            }

            connectedCallback() {
                this.render();
                this.setupEventListeners();
            }

            attributeChangedCallback() {
                this.render();
                this.setupEventListeners();
            }

            setupEventListeners() {
                const button = this.shadowRoot.querySelector('.btn');
                if (button) {
                    button.addEventListener('click', () => {
                        // Émission d'un événement personnalisé
                        const event = new CustomEvent('pricing-card-click', {
                            detail: {
                                title: this.getAttribute('title') || '',
                                price: this.getAttribute('price') || '',
                                cta: this.getAttribute('cta') || ''
                            },
                            bubbles: true,
                            cancelable: true
                        });
                        this.dispatchEvent(event);
                        
                        // Log pour démonstration
                        console.log('Carte de prix cliquée:', {
                            title: this.getAttribute('title'),
                            price: this.getAttribute('price'),
                            cta: this.getAttribute('cta')
                        });
                    });
                }
            }

            parseFeatures() {
                try {
                    const featuresAttr = this.getAttribute('features') || '[]';
                    return JSON.parse(featuresAttr);
                } catch (e) {
                    return [];
                }
            }

            render() {
                const title = this.getAttribute('title') || 'Forfait';
                const price = this.getAttribute('price') || '0';
                const currency = this.getAttribute('currency') || '€';
                const period = this.getAttribute('period') || 'mois';
                const cta = this.getAttribute('cta') || 'Choisir';
                const featured = this.hasAttribute('featured');
                const features = this.parseFeatures();

                this.shadowRoot.innerHTML = `
                    <style>
                        :host {
                            display: block;
                        }

                        .pricing-card {
                            width: 100%;
                            max-width: 350px;
                            margin: 0 auto;
                            background-color: #ffffff;
                            border-radius: 16px;
                            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1), 
                                        0 10px 20px rgba(0, 0, 0, 0.15);
                            padding: 32px 24px;
                            text-align: left;
                            transition: transform 0.3s ease, box-shadow 0.3s ease;
                            position: relative;
                            overflow: hidden;
                        }

                        .pricing-card:hover {
                            transform: translateY(-8px);
                            box-shadow: 0 8px 12px rgba(0, 0, 0, 0.15), 
                                        0 20px 40px rgba(0, 0, 0, 0.2);
                        }

                        .pricing-card.featured {
                            border: 2px solid #667eea;
                            transform: scale(1.05);
                        }

                        .pricing-card.featured::before {
                            content: '⭐ Populaire';
                            position: absolute;
                            top: 16px;
                            right: -30px;
                            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                            color: white;
                            padding: 4px 40px;
                            font-size: 12px;
                            font-weight: 600;
                            transform: rotate(45deg);
                            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
                        }

                        .title {
                            font-size: 24px;
                            font-weight: 700;
                            color: #1a202c;
                            margin-bottom: 16px;
                            line-height: 1.2;
                        }

                        .price-container {
                            margin-bottom: 24px;
                        }

                        .price {
                            font-size: 36px;
                            font-weight: 800;
                            color: #667eea;
                            line-height: 1;
                            margin-bottom: 4px;
                        }

                        .price-details {
                            font-size: 14px;
                            color: #718096;
                            margin-top: 4px;
                        }

                        .features {
                            list-style: none;
                            padding: 0;
                            margin: 0 0 32px 0;
                        }

                        .features li {
                            padding: 12px 0;
                            border-bottom: 1px solid #e2e8f0;
                            color: #4a5568;
                            font-size: 15px;
                            line-height: 1.5;
                            position: relative;
                            padding-left: 28px;
                        }

                        .features li:last-child {
                            border-bottom: none;
                        }

                        .features li::before {
                            content: '✓';
                            position: absolute;
                            left: 0;
                            color: #48bb78;
                            font-weight: bold;
                            font-size: 18px;
                        }

                        .btn {
                            width: 100%;
                            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                            color: white;
                            padding: 14px 24px;
                            border: none;
                            border-radius: 8px;
                            font-size: 16px;
                            font-weight: 600;
                            cursor: pointer;
                            transition: all 0.3s ease;
                            box-shadow: 0 4px 6px rgba(102, 126, 234, 0.3);
                        }

                        .btn:hover {
                            background: linear-gradient(135deg, #5568d3 0%, #6a3d91 100%);
                            transform: translateY(-2px);
                            box-shadow: 0 6px 12px rgba(102, 126, 234, 0.4);
                        }

                        .btn:active {
                            transform: translateY(0);
                            box-shadow: 0 2px 4px rgba(102, 126, 234, 0.3);
                        }

                        .btn:focus {
                            outline: 3px solid rgba(102, 126, 234, 0.5);
                            outline-offset: 2px;
                        }

                        /* Responsive */
                        @media (max-width: 768px) {
                            .pricing-card {
                                max-width: 100%;
                                padding: 24px 20px;
                            }

                            .pricing-card.featured {
                                transform: scale(1);
                            }

                            .title {
                                font-size: 22px;
                            }

                            .price {
                                font-size: 32px;
                            }
                        }

                        @media (max-width: 480px) {
                            .pricing-card {
                                padding: 20px 16px;
                            }
                        }
                    </style>

                    <div class="pricing-card ${featured ? 'featured' : ''}" role="article" aria-labelledby="pricing-title">
                        <h2 class="title" id="pricing-title">${this.escapeHtml(title)}</h2>
                        
                        <div class="price-container">
                            <div class="price">
                                ${this.escapeHtml(price)} <span style="font-size: 24px;">${this.escapeHtml(currency)}</span>
                            </div>
                            <div class="price-details">par ${this.escapeHtml(period)}</div>
                        </div>

                        <ul class="features" role="list">
                            ${features.map(feature => `
                                <li role="listitem">${this.escapeHtml(feature)}</li>
                            `).join('')}
                        </ul>

                        <button class="btn" aria-label="Choisir le forfait ${this.escapeHtml(title)}">
                            ${this.escapeHtml(cta)}
                        </button>
                    </div>
                `;
            }

            escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }
        }

        // Enregistrer le Web Component
        customElements.define('pricing-card', PricingCard);

        // Exemple d'écoute d'événements personnalisés
        document.addEventListener('pricing-card-click', (event) => {
            console.log('Événement reçu:', event.detail);
        });
    </script>
</body>
</html>